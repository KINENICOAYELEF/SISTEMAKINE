<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SISTEMAKINE - Nuevo Paciente</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/mapa-corporal.css">
  <link rel="stylesheet" href="css/cuestionarios.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body class="app-only">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="sidebar-brand">
        <i class="fas fa-heartbeat"></i> SISTEMAKINE
      </div>
    </div>
    <nav class="sidebar-nav">
      <div class="sidebar-item">
        <a href="dashboard.html" class="sidebar-link">
          <i class="fas fa-home"></i>
          <span>Dashboard</span>
        </a>
      </div>
      <div class="sidebar-item">
        <a href="nuevo-paciente.html" class="sidebar-link active">
          <i class="fas fa-user-plus"></i>
          <span>Nuevo Paciente</span>
        </a>
      </div>
      <div class="sidebar-item">
        <a href="listado-pacientes.html" class="sidebar-link">
          <i class="fas fa-users"></i>
          <span>Listado Pacientes</span>
        </a>
      </div>
      <div class="sidebar-item">
        <a href="#" id="logout-btn" class="sidebar-link">
          <i class="fas fa-sign-out-alt"></i>
          <span>Cerrar Sesión</span>
        </a>
      </div>
    </nav>
  </aside>
  
  <!-- Main Content -->
  <main class="content">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1 id="page-title">Nuevo Paciente</h1>
      <a href="listado-pacientes.html" class="btn btn-secondary">
        <i class="fas fa-arrow-left"></i> Volver
      </a>
    </div>
    
    <!-- Form Tabs -->
    <div class="card-header">
  <ul class="tab-nav">
    <li><a class="tab-link active" data-tab="datos-personales">1. Datos Personales</a></li>
    <li><a class="tab-link" data-tab="motivo-consulta">2. Motivo de Consulta</a></li>
    <li><a class="tab-link" data-tab="cuestionarios">3. Cuestionarios</a></li>
    <li><a class="tab-link" data-tab="historia-medica">4. Historia Médica</a></li>
    <li><a class="tab-link" data-tab="habitos">5. Hábitos</a></li>
    <li><a class="tab-link" data-tab="evaluacion-fisica">6. Evaluación Física</a></li>
    <li><a class="tab-link" data-tab="escalas">7. Escalas</a></li>
    <li><a class="tab-link" data-tab="banderas">8. Banderas</a></li>
    <li><a class="tab-link" data-tab="documentos">9. Documentos</a></li>
    <li><a class="tab-link" data-tab="plan">10. Plan de Tratamiento</a></li>
  </ul>
</div>
      <div class="card-body">
        <!-- Loading indicator -->
        <div id="loading-form" class="text-center py-4" style="display: none;">
          <i class="fas fa-spinner fa-spin fa-2x"></i>
          <p>Cargando datos del paciente...</p>
        </div>
        
        <!-- Patient Form -->
        <form id="patient-form">
          <!-- Hidden fields for editing -->
          <input type="hidden" id="patient-id" name="id">
          
          <!-- 1. Datos Personales -->
          <div class="tab-content active" id="datos-personales">
            <h3>1. Identificación del Paciente</h3>
            
            <h4>1.1 Datos Personales</h4>
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="nombreCompleto" class="form-label">Nombre completo</label>
                  <input type="text" id="nombreCompleto" name="nombreCompleto" class="form-control" required>
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="documentoIdentidad" class="form-label">Documento de identidad (RUT/Pasaporte)</label>
                  <input type="text" id="documentoIdentidad" name="documentoIdentidad" class="form-control">
                </div>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="fechaNacimiento" class="form-label">Fecha de nacimiento</label>
                  <input type="date" id="fechaNacimiento" name="fechaNacimiento" class="form-control">
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="genero" class="form-label">Género</label>
                  <select id="genero" name="genero" class="form-select">
                    <option value="">Seleccionar</option>
                    <option value="Masculino">Masculino</option>
                    <option value="Femenino">Femenino</option>
                    <option value="No binario">No binario</option>
                    <option value="Prefiero no especificar">Prefiero no especificar</option>
                  </select>
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="estadoCivil" class="form-label">Estado civil</label>
                  <select id="estadoCivil" name="estadoCivil" class="form-select">
                    <option value="">Seleccionar</option>
                    <option value="Soltero/a">Soltero/a</option>
                    <option value="Casado/a">Casado/a</option>
                    <option value="Divorciado/a">Divorciado/a</option>
                    <option value="Viudo/a">Viudo/a</option>
                    <option value="Unión libre">Unión libre</option>
                  </select>
                </div>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <label for="nacionalidad" class="form-label">Nacionalidad</label>
                  <input type="text" id="nacionalidad" name="nacionalidad" class="form-control">
                </div>
              </div>
            </div>
            
            <h4>1.2 Información de Contacto</h4>
            <div class="form-row">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <label for="direccion" class="form-label">Dirección completa</label>
                  <input type="text" id="direccion" name="direccion" class="form-control">
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <label for="comuna" class="form-label">Comuna en la que reside</label>
                  <input type="text" id="comuna" name="comuna" class="form-control">
                </div>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="telefonoPersonal" class="form-label">Teléfono personal</label>
                  <input type="tel" id="telefonoPersonal" name="telefonoPersonal" class="form-control">
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="telefonoTrabajo" class="form-label">Teléfono trabajo</label>
                  <input type="tel" id="telefonoTrabajo" name="telefonoTrabajo" class="form-control">
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="correoElectronico" class="form-label">Correo electrónico</label>
                  <input type="email" id="correoElectronico" name="correoElectronico" class="form-control">
                </div>
              </div>
            </div>
            
            <h4>1.3 Datos Sociolaborales</h4>
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="nivelEducacional" class="form-label">Nivel educacional</label>
                  <select id="nivelEducacional" name="nivelEducacional" class="form-select">
                    <option value="">Seleccionar</option>
                    <option value="Básica">Básica</option>
                    <option value="Media">Media</option>
                    <option value="Técnica">Técnica</option>
                    <option value="Universitaria">Universitaria</option>
                    <option value="Postgrado">Postgrado</option>
                  </select>
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="ocupacionActual" class="form-label">Ocupación actual</label>
                  <input type="text" id="ocupacionActual" name="ocupacionActual" class="form-control">
                </div>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="tipoTrabajo" class="form-label">Tipo de trabajo</label>
                  <select id="tipoTrabajo" name="tipoTrabajo" class="form-select">
                    <option value="">Seleccionar</option>
                    <option value="Físico">Físico</option>
                    <option value="Sedentario">Sedentario</option>
                    <option value="Mixto">Mixto</option>
                  </select>
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="horarioLaboral" class="form-label">Horario laboral</label>
                  <input type="text" id="horarioLaboral" name="horarioLaboral" class="form-control">
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="nivelActividadFisica" class="form-label">Nivel de actividad física</label>
                  <select id="nivelActividadFisica" name="nivelActividadFisica" class="form-select">
                    <option value="">Seleccionar</option>
                    <option value="Sedentario">Sedentario</option>
                    <option value="Ligero">Ligero</option>
                    <option value="Moderado">Moderado</option>
                    <option value="Intenso">Intenso</option>
                  </select>
                </div>
              </div>
            </div>
            
            <h4>1.4 Información de Emergencia</h4>
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="contactoEmergencia" class="form-label">Contacto de emergencia</label>
                  <input type="text" id="contactoEmergencia" name="contactoEmergencia" class="form-control">
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="parentesco" class="form-label">Parentesco</label>
                  <input type="text" id="parentesco" name="parentesco" class="form-control">
                </div>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="telefonosContacto" class="form-label">Teléfonos de contacto</label>
                  <input type="text" id="telefonosContacto" name="telefonosContacto" class="form-control">
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="sistemaSalud" class="form-label">Sistema de salud/seguro médico</label>
                  <input type="text" id="sistemaSalud" name="sistemaSalud" class="form-control">
                </div>
              </div>
            </div>

            <h4>1.5 Lateralidad</h4>
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="dominanciaManual" class="form-label">Dominancia manual</label>
                  <select id="dominanciaManual" name="dominanciaManual" class="form-select">
                    <option value="">Seleccionar</option>
                    <option value="Diestro">Diestro</option>
                    <option value="Zurdo">Zurdo</option>
                    <option value="Ambidiestro">Ambidiestro</option>
                  </select>
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="dominanciaPodal" class="form-label">Dominancia podal</label>
                  <select id="dominanciaPodal" name="dominanciaPodal" class="form-select">
                    <option value="">Seleccionar</option>
                    <option value="Derecha">Derecha</option>
                    <option value="Izquierda">Izquierda</option>
                    <option value="Ambas">Ambas</option>
                  </select>
                </div>
              </div>
            </div>
            
            <div class="form-row mt-4">
              <div class="form-col form-col-md-12 text-right">
                <button type="button" class="btn btn-primary next-tab" data-next="motivo-consulta">Siguiente <i class="fas fa-arrow-right"></i></button>
              </div>
            </div>
          </div>
          
          <!-- 2. Motivo de Consulta -->
          <div class="tab-content" id="motivo-consulta">
            <h3>2. Motivo de Consulta y Antecedentes</h3>
            
            <h4>2.1 Derivación</h4>
            <div class="form-row mb-3">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="profesionalDeriva" class="form-label">Profesional que deriva</label>
                  <input type="text" id="profesionalDeriva" name="profesionalDeriva" class="form-control">
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="especialidad" class="form-label">Especialidad</label>
                  <select id="especialidad" name="especialidad" class="form-select">
                    <option value="">Seleccionar</option>
                    <option value="Medicina General">Medicina General</option>
                    <option value="Traumatología">Traumatología</option>
                    <option value="Neurología">Neurología</option>
                    <option value="Reumatología">Reumatología</option>
                    <option value="Medicina Deportiva">Medicina Deportiva</option>
                    <option value="Geriatría">Geriatría</option>
                    <option value="Fisiatría">Fisiatría</option>
                    <option value="Otro">Otro</option>
                  </select>
                </div>
              </div>
            </div>
            
            <div class="form-row mb-3">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <label for="diagnosticoInicial" class="form-label">Diagnóstico médico inicial</label>
                  <input type="text" id="diagnosticoInicial" name="diagnosticoInicial" class="form-control">
                </div>
              </div>
            </div>
            
            <div class="form-row mb-3">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <label for="motivoConsulta" class="form-label">Motivo de consulta específico</label>
                  <textarea id="motivoConsulta" name="motivoConsulta" class="form-control" rows="3"></textarea>
                </div>
              </div>
            </div>
            
            <!-- Código para la sección completa de Historia de la Condición Actual con mejoras -->

<h4 class="mt-4">2.2 Historia de la Condición Actual</h4>
<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <div class="form-group">
      <label for="mecanismoLesion" class="form-label">Mecanismo de lesión/aparición</label>
      <select id="mecanismoLesion" name="mecanismoLesion" class="form-select">
        <option value="">Seleccionar</option>
        <option value="Traumático">Traumático</option>
        <option value="Gradual">Gradual</option>
        <option value="Postural">Postural</option>
        <option value="Post-quirúrgico">Post-quirúrgico</option>
        <option value="Desconocido">Desconocido</option>
        <option value="Otro">Otro</option>
      </select>
      <textarea id="mecanismoLesionDetalles" name="mecanismoLesionDetalles" class="form-control mt-3" rows="3" placeholder="Detalles del mecanismo de lesión..."></textarea>
    </div>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <div class="form-group">
      <label for="anamnesisProxima" class="form-label">Anamnesis próxima</label>
      <textarea id="anamnesisProxima" name="anamnesisProxima" class="form-control" rows="3"></textarea>
    </div>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <div class="form-group">
      <label for="cambiosDiurnosVespertinos" class="form-label">Cambios diurnos y vespertinos</label>
      <textarea id="cambiosDiurnosVespertinos" name="cambiosDiurnosVespertinos" class="form-control" rows="3"></textarea>
    </div>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <div class="form-group">
      <label for="tratamientosPrevios" class="form-label">Tratamientos previos</label>
      <textarea id="tratamientosPrevios" name="tratamientosPrevios" class="form-control" rows="3"></textarea>
    </div>
  </div>
</div>

<h4 class="mt-4">Acrónimo ALICIA</h4>
<div class="form-row mb-4">
  <div class="form-col form-col-md-6">
    <div class="form-group">
      <label for="alicia_antiguedad" class="form-label">Antigüedad</label>
      <textarea id="alicia_antiguedad" name="alicia_antiguedad" class="form-control" rows="3"></textarea>
    </div>
  </div>
  <div class="form-col form-col-md-6">
    <div class="form-group">
      <label for="alicia_localizacion" class="form-label">Localización</label>
      <textarea id="alicia_localizacion" name="alicia_localizacion" class="form-control" rows="3"></textarea>
    </div>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-4">
    <div class="form-group">
      <label for="alicia_intensidad" class="form-label">Intensidad (ENA 0-10)</label>
      <div class="w-100">
        <input type="range" id="alicia_intensidad" name="alicia_intensidad" class="form-range w-100" min="0" max="10" step="1" value="5" oninput="document.getElementById('alicia_intensidad_value').textContent = this.value;">
        <div class="d-flex justify-content-between mt-2">
          <span>0</span>
          <span id="alicia_intensidad_value">5</span>
          <span>10</span>
        </div>
      </div>
    </div>
  </div>
  <div class="form-col form-col-md-4">
    <div class="form-group">
      <label for="alicia_caracteristicas" class="form-label">Características</label>
      <textarea id="alicia_caracteristicas" name="alicia_caracteristicas" class="form-control" rows="3"></textarea>
    </div>
  </div>
  <div class="form-col form-col-md-4">
    <div class="form-group">
      <label for="alicia_irradiacion" class="form-label">Irradiación</label>
      <textarea id="alicia_irradiacion" name="alicia_irradiacion" class="form-control" rows="3"></textarea>
    </div>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-6">
    <div class="form-group">
      <label for="alicia_atenuantes" class="form-label">Atenuantes</label>
      <textarea id="alicia_atenuantes" name="alicia_atenuantes" class="form-control" rows="3"></textarea>
    </div>
  </div>
  <div class="form-col form-col-md-6">
    <div class="form-group">
      <label for="alicia_agravantes" class="form-label">Agravantes</label>
      <textarea id="alicia_agravantes" name="alicia_agravantes" class="form-control" rows="3"></textarea>
    </div>
  </div>
</div>

<h4 class="mt-4">2.3 Expectativas del Paciente</h4>
<div class="form-row mb-4">
  <div class="form-col form-col-md-4">
    <div class="form-group">
      <label for="objetivosCorto" class="form-label">Objetivos a corto plazo</label>
      <textarea id="objetivosCorto" name="objetivosCorto" class="form-control" rows="3"></textarea>
    </div>
  </div>
  <div class="form-col form-col-md-4">
    <div class="form-group">
      <label for="objetivosMediano" class="form-label">Objetivos a mediano plazo</label>
      <textarea id="objetivosMediano" name="objetivosMediano" class="form-control" rows="3"></textarea>
    </div>
  </div>
  <div class="form-col form-col-md-4">
    <div class="form-group">
      <label for="objetivosLargo" class="form-label">Objetivos a largo plazo</label>
      <textarea id="objetivosLargo" name="objetivosLargo" class="form-control" rows="3"></textarea>
    </div>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-6">
    <div class="form-group">
      <label for="expectativasRecuperacion" class="form-label">Expectativas de recuperación</label>
      <select id="expectativasRecuperacion" name="expectativasRecuperacion" class="form-select">
        <option value="">Seleccionar</option>
        <option value="Recuperación completa">Recuperación completa</option>
        <option value="Mejora significativa">Mejora significativa</option>
        <option value="Mejora parcial">Mejora parcial</option>
        <option value="Control de síntomas">Control de síntomas</option>
        <option value="Sin expectativas claras">Sin expectativas claras</option>
      </select>
    </div>
  </div>
  <div class="form-col form-col-md-6">
    <div class="form-group">
      <label for="nivelCompromiso" class="form-label">Nivel de compromiso con el tratamiento</label>
      <select id="nivelCompromiso" name="nivelCompromiso" class="form-select">
        <option value="">Seleccionar</option>
        <option value="Alto">Alto</option>
        <option value="Medio">Medio</option>
        <option value="Bajo">Bajo</option>
      </select>
    </div>
  </div>
</div>

            <h4 class="mt-4">2.4 Evaluación SINSS</h4>
<div class="form-row mb-3">
  <div class="form-col form-col-md-12">
    <p><strong>Introducción:</strong> El modelo SINSS (Severidad, Irritabilidad, Naturaleza, Etapa, Estabilidad) ayuda a comprender los síntomas del paciente, a guiar el examen físico y a determinar el tratamiento adecuado en fisioterapia.</p>
  </div>
</div>

<!-- Severidad -->
<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <h5>Severidad - Intensidad del dolor e impacto en la vida diaria</h5>
    <p><small>Evalúa la intensidad del dolor y cómo afecta las actividades de la vida diaria (AVD) del paciente</small></p>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-4">
    <div class="form-group">
      <label for="sinss_severidad_escala" class="form-label">Escala de dolor (EVA/NRS)</label>
      <input type="range" id="sinss_severidad_escala" name="sinss_severidad_escala" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('sinss_severidad_escala_value').textContent = this.value;">
      <div class="d-flex justify-content-between mt-2">
        <span>0</span>
        <span id="sinss_severidad_escala_value">0</span>
        <span>10</span>
      </div>
    </div>
  </div>
  <div class="form-col form-col-md-4">
  <div class="form-group">
    <label for="sinss_severidad_impacto" class="form-label">Impacto en las AVD</label>
    <div class="checkbox-group">
      <div class="form-check">
        <input type="checkbox" id="sinss_severidad_impacto_minimo" name="sinss_severidad_impacto[]" value="Mínimo" class="form-check-input">
        <label class="form-check-label" for="sinss_severidad_impacto_minimo">Mínimo</label>
      </div>
      <div class="form-check">
        <input type="checkbox" id="sinss_severidad_impacto_moderado" name="sinss_severidad_impacto[]" value="Moderado" class="form-check-input">
        <label class="form-check-label" for="sinss_severidad_impacto_moderado">Moderado</label>
      </div>
      <div class="form-check">
        <input type="checkbox" id="sinss_severidad_impacto_maximo" name="sinss_severidad_impacto[]" value="Máximo" class="form-check-input">
        <label class="form-check-label" for="sinss_severidad_impacto_maximo">Máximo</label>
      </div>
    </div>
  </div>
</div>
  <div class="form-col form-col-md-4">
    <div class="form-group">
      <label for="sinss_severidad_medicacion" class="form-label">Medicación</label>
      <textarea id="sinss_severidad_medicacion" name="sinss_severidad_medicacion" class="form-control" rows="2"></textarea>
    </div>
  </div>
</div>

<div id="severidad_adicional_container">
  <!-- Aquí se agregarán campos adicionales de severidad -->
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <button type="button" class="btn btn-outline-secondary btn-sm" id="agregar_severidad_btn">
      <i class="fas fa-plus"></i> Agregar campo adicional de severidad
    </button>
  </div>
</div>

<!-- Irritabilidad -->
<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <h5>Irritabilidad - Facilidad con la que se agravan los síntomas</h5>
    <p><small>Evalúa con qué facilidad se agravan los síntomas del paciente, la gravedad de los mismos y el tiempo que tardan en disminuir</small></p>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <div class="form-group">
      <label for="sinss_irritabilidad_actividad" class="form-label">Actividad necesaria para provocar síntomas</label>
      <textarea id="sinss_irritabilidad_actividad" name="sinss_irritabilidad_actividad" class="form-control" rows="2"></textarea>
    </div>
  </div>
</div>

<div id="irritabilidad_actividades_container">
  <!-- Aquí se agregarán campos adicionales de actividades -->
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <button type="button" class="btn btn-outline-secondary btn-sm" id="agregar_actividad_btn">
      <i class="fas fa-plus"></i> Agregar otra actividad
    </button>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-6">
    <div class="form-group">
      <label for="sinss_irritabilidad_gravedad" class="form-label">Gravedad de los síntomas</label>
      <select id="sinss_irritabilidad_gravedad" name="sinss_irritabilidad_gravedad" class="form-select">
        <option value="">Seleccionar</option>
        <option value="Leve">Leve</option>
        <option value="Moderada">Moderada</option>
        <option value="Grave">Grave</option>
      </select>
    </div>
  </div>
  <div class="form-col form-col-md-6">
    <div class="form-group">
      <label for="sinss_irritabilidad_tiempo" class="form-label">Tiempo de recuperación</label>
      <select id="sinss_irritabilidad_tiempo" name="sinss_irritabilidad_tiempo" class="form-select">
        <option value="">Seleccionar</option>
        <option value="< 30 min">< 30 min</option>
        <option value="30 - 60 min">30 - 60 min</option>
        <option value="> 60 min">> 60 min</option>
      </select>
    </div>
  </div>
</div>

<div id="irritabilidad_adicional_container">
  <!-- Aquí se agregarán campos adicionales de irritabilidad -->
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <button type="button" class="btn btn-outline-secondary btn-sm" id="agregar_irritabilidad_btn">
      <i class="fas fa-plus"></i> Agregar campo adicional de irritabilidad
    </button>
  </div>
</div>

<!-- Naturaleza -->
<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <h5>Naturaleza - Diagnóstico, tipo de dolor y factores biopsicosociales</h5>
    <p><small>Considera el diagnóstico del paciente, el tipo de síntomas que experimenta y los factores biopsicosociales que pueden estar influyendo en su condición</small></p>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <div class="form-group">
      <label for="sinss_naturaleza_diagnostico" class="form-label">Diagnóstico</label>
      <textarea id="sinss_naturaleza_diagnostico" name="sinss_naturaleza_diagnostico" class="form-control" rows="2"></textarea>
    </div>
  </div>
</div>

<div id="naturaleza_diagnostico_container">
  <!-- Aquí se agregarán campos adicionales de diagnóstico -->
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <button type="button" class="btn btn-outline-secondary btn-sm" id="agregar_diagnostico_btn">
      <i class="fas fa-plus"></i> Agregar otro diagnóstico
    </button>
  </div>
</div>

<div class="form-col form-col-md-12">
  <div class="form-group">
    <label for="sinss_naturaleza_dolor" class="form-label">Tipo de dolor</label>
    <div class="checkbox-group">
      <div class="form-row">
        <div class="form-col form-col-md-3">
          <div class="form-check">
            <input type="checkbox" id="sinss_naturaleza_dolor_punzante" name="sinss_naturaleza_dolor[]" value="Punzante" class="form-check-input">
            <label class="form-check-label" for="sinss_naturaleza_dolor_punzante">Punzante</label>
          </div>
        </div>
        <div class="form-col form-col-md-3">
          <div class="form-check">
            <input type="checkbox" id="sinss_naturaleza_dolor_quemante" name="sinss_naturaleza_dolor[]" value="Quemante" class="form-check-input">
            <label class="form-check-label" for="sinss_naturaleza_dolor_quemante">Quemante</label>
          </div>
        </div>
        <div class="form-col form-col-md-3">
          <div class="form-check">
            <input type="checkbox" id="sinss_naturaleza_dolor_sordo" name="sinss_naturaleza_dolor[]" value="Sordo" class="form-check-input">
            <label class="form-check-label" for="sinss_naturaleza_dolor_sordo">Sordo</label>
          </div>
        </div>
        <div class="form-col form-col-md-3">
          <div class="form-check">
            <input type="checkbox" id="sinss_naturaleza_dolor_lancinante" name="sinss_naturaleza_dolor[]" value="Lancinante" class="form-check-input">
            <label class="form-check-label" for="sinss_naturaleza_dolor_lancinante">Lancinante</label>
          </div>
        </div>
      </div>
      <div class="form-row">
        <div class="form-col form-col-md-3">
          <div class="form-check">
            <input type="checkbox" id="sinss_naturaleza_dolor_electrico" name="sinss_naturaleza_dolor[]" value="Eléctrico" class="form-check-input">
            <label class="form-check-label" for="sinss_naturaleza_dolor_electrico">Eléctrico</label>
          </div>
        </div>
        <div class="form-col form-col-md-3">
          <div class="form-check">
            <input type="checkbox" id="sinss_naturaleza_dolor_pulsatil" name="sinss_naturaleza_dolor[]" value="Pulsátil" class="form-check-input">
            <label class="form-check-label" for="sinss_naturaleza_dolor_pulsatil">Pulsátil</label>
          </div>
        </div>
        <div class="form-col form-col-md-3">
          <div class="form-check">
            <input type="checkbox" id="sinss_naturaleza_dolor_opresivo" name="sinss_naturaleza_dolor[]" value="Opresivo" class="form-check-input">
            <label class="form-check-label" for="sinss_naturaleza_dolor_opresivo">Opresivo</label>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="naturaleza_dolor_container">
  <!-- Aquí se agregarán campos adicionales de tipo de dolor -->
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <button type="button" class="btn btn-outline-secondary btn-sm" id="agregar_dolor_btn">
      <i class="fas fa-plus"></i> Agregar otra característica de dolor
    </button>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <div class="form-group">
      <label for="sinss_naturaleza_factores" class="form-label">Factores biopsicosociales</label>
      <textarea id="sinss_naturaleza_factores" name="sinss_naturaleza_factores" class="form-control" rows="2"></textarea>
    </div>
  </div>
</div>

<div id="naturaleza_factores_container">
  <!-- Aquí se agregarán campos adicionales de factores biopsicosociales -->
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <button type="button" class="btn btn-outline-secondary btn-sm" id="agregar_factores_btn">
      <i class="fas fa-plus"></i> Agregar otros factores
    </button>
  </div>
</div>

<!-- Etapa -->
<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <h5>Etapa - Fase de la lesión o condición</h5>
    <p><small>Determina la fase actual de la lesión o condición del paciente</small></p>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-6">
    <div class="form-group">
      <label for="sinss_etapa" class="form-label">Etapa</label>
      <select id="sinss_etapa" name="sinss_etapa" class="form-select">
        <option value="">Seleccionar</option>
        <option value="Aguda">Aguda</option>
        <option value="Subaguda">Subaguda</option>
        <option value="Crónica">Crónica</option>
      </select>
    </div>
  </div>
</div>

<!-- Estabilidad -->
<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <h5>Estabilidad - Progresión de los síntomas en el tiempo</h5>
    <p><small>Describe cómo han evolucionado los síntomas del paciente a lo largo del tiempo</small></p>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-6">
    <div class="form-group">
      <label for="sinss_estabilidad" class="form-label">Estabilidad</label>
      <select id="sinss_estabilidad" name="sinss_estabilidad" class="form-select">
        <option value="">Seleccionar</option>
        <option value="Empeorando">Empeorando</option>
        <option value="Mejorando">Mejorando</option>
        <option value="Sin cambios">Sin cambios</option>
        <option value="Fluctuante">Fluctuante</option>
      </select>
    </div>
  </div>
  <div class="form-col form-col-md-6">
    <div class="form-group">
      <label for="sinss_estabilidad_descripcion" class="form-label">Descripción de la evolución</label>
      <textarea id="sinss_estabilidad_descripcion" name="sinss_estabilidad_descripcion" class="form-control" rows="2"></textarea>
    </div>
  </div>
</div>

<div id="estabilidad_adicional_container">
  <!-- Aquí se agregarán campos adicionales de estabilidad -->
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <button type="button" class="btn btn-outline-secondary btn-sm" id="agregar_estabilidad_btn">
      <i class="fas fa-plus"></i> Agregar campo adicional de estabilidad
    </button>
  </div>
</div>

<!-- Comentarios adicionales -->
<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <h5>Comentarios adicionales</h5>
    <div class="form-group">
      <textarea id="sinss_comentarios" name="sinss_comentarios" class="form-control" rows="3" placeholder="Espacio para registrar cualquier observación adicional sobre la evaluación SINSS del paciente"></textarea>
    </div>
  </div>
</div>

<!-- Sección 2.5 Mapa Corporal Interactivo -->
<h4 class="mt-4">2.5 Mapa Corporal Interactivo</h4>
<div class="form-row mb-3">
  <div class="form-col form-col-md-12">
    <p><strong>Instrucciones:</strong> Utilice las herramientas para marcar en el mapa corporal la ubicación de los síntomas del paciente. Puede seleccionar diferentes tipos de síntomas, asignar intensidad al dolor y usar diferentes colores para distinguirlos.</p>
  </div>
</div>

<div class="form-row mb-4">
  <div class="form-col form-col-md-3">
    <div class="mapa-tools">
      <h5>Herramientas</h5>
      
      <!-- Selector de tipo de síntoma -->
      <div class="form-group mb-3">
        <label for="sintoma-tipo" class="form-label">Tipo de síntoma</label>
        <select id="sintoma-tipo" class="form-select">
          <option value="dolor">Dolor</option>
          <option value="parestesia">Parestesia</option>
          <option value="debilidad">Debilidad</option>
          <option value="rigidez">Rigidez</option>
          <option value="inestabilidad">Inestabilidad</option>
        </select>
      </div>
      
      <!-- Intensidad del dolor (solo visible cuando se selecciona dolor) -->
      <div id="dolor-intensidad-container" class="form-group mb-3">
        <label for="dolor-intensidad" class="form-label">Intensidad del dolor (0-10)</label>
        <input type="range" id="dolor-intensidad" class="form-range w-100" min="0" max="10" step="1" value="5" oninput="document.getElementById('dolor-intensidad-value').textContent = this.value;">
        <div class="d-flex justify-content-between mt-1">
          <span>0</span>
          <span id="dolor-intensidad-value">5</span>
          <span>10</span>
        </div>
      </div>
      
      <!-- Selector de color -->
      <div class="form-group mb-3">
        <label for="sintoma-color" class="form-label">Color</label>
        <input type="color" id="sintoma-color" class="form-control" value="#ff0000">
      </div>
      
      <!-- Selector de herramienta -->
      <div class="form-group mb-3">
        <label class="form-label">Modo</label>
        <div class="btn-group d-flex mb-2" role="group">
          <button type="button" id="tool-marker" class="btn btn-outline-primary active">Marcar</button>
          <button type="button" id="tool-arrow" class="btn btn-outline-primary">Irradiación</button>
        </div>
        <div class="btn-group d-flex" role="group">
          <button type="button" id="tool-eraser" class="btn btn-outline-danger">Borrador</button>
          <button type="button" id="tool-clear" class="btn btn-outline-secondary">Limpiar</button>
        </div>
      </div>
      
      <!-- Botón para guardar marcas del mapa -->
      <div class="form-group mb-3">
        <button type="button" id="save-map-btn" class="btn btn-success w-100">
          <i class="fas fa-save"></i> Guardar marcas
        </button>
      </div>
      
      <!-- Leyenda de síntomas -->
      <div id="mapa-leyenda">
        <h6>Leyenda</h6>
        <div id="leyenda-items">
          <!-- La leyenda se generará dinámicamente con JavaScript -->
          <p class="text-muted">No hay síntomas marcados</p>
        </div>
      </div>
    </div>
  </div>
  
  <div class="form-col form-col-md-9">
    <div class="mapa-container">
      <!-- Títulos de las vistas -->
      <h5 class="text-center mb-3">Vista Anterior</h5>
      
      <!-- Vista Anterior -->
      <div id="container-anterior" class="mapa-canvas-container mb-4">
        <img src="img/body-map-front.jpg" id="body-map-front" class="body-map-img" alt="Vista anterior del cuerpo humano">
        <canvas id="canvas-anterior" class="mapa-canvas"></canvas>
      </div>
      
      <h5 class="text-center mb-3">Vista Posterior</h5>
      
      <!-- Vista Posterior -->
      <div id="container-posterior" class="mapa-canvas-container">
        <img src="img/body-map-back.jpg" id="body-map-back" class="body-map-img" alt="Vista posterior del cuerpo humano">
        <canvas id="canvas-posterior" class="mapa-canvas"></canvas>
      </div>
    </div>
  </div>
</div>

<!-- Notas adicionales sobre el mapa -->
<div class="form-row mb-4">
  <div class="form-col form-col-md-12">
    <div class="form-group">
      <label for="mapa-notas" class="form-label">Notas adicionales sobre el mapa corporal</label>
      <textarea id="mapa-notas" name="mapa-notas" class="form-control" rows="3" placeholder="Ingrese observaciones adicionales sobre los síntomas marcados en el mapa..."></textarea>
    </div>
  </div>
</div>

<!-- Campo oculto para almacenar los datos del mapa -->
<input type="hidden" id="mapa-datos" name="mapa-datos" value="">
            
            <div class="form-row mt-4">
              <div class="form-col form-col-md-12">
                <button type="button" class="btn btn-secondary prev-tab" data-prev="datos-personales"><i class="fas fa-arrow-left"></i> Anterior</button>
                <button type="button" class="btn btn-primary next-tab" data-next="cuestionarios">Siguiente <i class="fas fa-arrow-right"></i></button>
              </div>
            </div>
          </div>


          <!-- 3. Cuestionarios -->
<div class="tab-content" id="cuestionarios">
  <h3>3. Cuestionarios Clínicos</h3>
  <p class="mb-3">Seleccione los cuestionarios apropiados para la condición del paciente. Los resultados se interpretan automáticamente con códigos de color.</p>
  
  <!-- Acordeón de cuestionarios -->
  <div class="cuestionarios-acordeon">
    <!-- PSFS (Patient-Specific Functional Scale) -->
    <div class="cuestionario-item">
      <div class="cuestionario-header" onclick="toggleCuestionario('psfs-content')">
        <h4><i class="fas fa-plus-circle"></i> PSFS (Patient-Specific Functional Scale)</h4>
        <div class="resultado-badge" id="psfs-badge">No completado</div>
      </div>
      <div class="cuestionario-content" id="psfs-content" style="display: none;">
        <p class="mb-3">Identificar hasta 3 actividades importantes que el paciente no puede realizar o tiene dificultad debido a su problema. Calificar la capacidad para realizar cada actividad en una escala de 0-10.</p>
        
        <div class="form-row mb-3">
          <div class="form-col form-col-md-8">
            <div class="form-group">
              <label for="psfs_actividad1" class="form-label">Actividad 1</label>
              <input type="text" id="psfs_actividad1" name="psfs_actividad1" class="form-control" placeholder="Ej: Subir escaleras, Levantar objetos pesados, etc.">
            </div>
          </div>
          <div class="form-col form-col-md-4">
            <div class="form-group">
              <label for="psfs_puntuacion1" class="form-label">Puntuación (0-10)</label>
              <select id="psfs_puntuacion1" name="psfs_puntuacion1" class="form-select" onchange="calcularPSFS()">
                <option value="">Seleccionar</option>
                <option value="0">0 - Incapaz de realizar la actividad</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10 - Capaz de realizar la actividad al mismo nivel que antes</option>
              </select>
            </div>
          </div>
        </div>
        
        <div class="form-row mb-3">
          <div class="form-col form-col-md-8">
            <div class="form-group">
              <label for="psfs_actividad2" class="form-label">Actividad 2</label>
              <input type="text" id="psfs_actividad2" name="psfs_actividad2" class="form-control" placeholder="Ej: Sentarse por periodos prolongados, Dormir, etc.">
            </div>
          </div>
          <div class="form-col form-col-md-4">
            <div class="form-group">
              <label for="psfs_puntuacion2" class="form-label">Puntuación (0-10)</label>
              <select id="psfs_puntuacion2" name="psfs_puntuacion2" class="form-select" onchange="calcularPSFS()">
                <option value="">Seleccionar</option>
                <option value="0">0 - Incapaz de realizar la actividad</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10 - Capaz de realizar la actividad al mismo nivel que antes</option>
              </select>
            </div>
          </div>
        </div>
        
        <div class="form-row mb-3">
          <div class="form-col form-col-md-8">
            <div class="form-group">
              <label for="psfs_actividad3" class="form-label">Actividad 3</label>
              <input type="text" id="psfs_actividad3" name="psfs_actividad3" class="form-control" placeholder="Ej: Girar el cuello, Practicar deporte, etc.">
            </div>
          </div>
          <div class="form-col form-col-md-4">
            <div class="form-group">
              <label for="psfs_puntuacion3" class="form-label">Puntuación (0-10)</label>
              <select id="psfs_puntuacion3" name="psfs_puntuacion3" class="form-select" onchange="calcularPSFS()">
                <option value="">Seleccionar</option>
                <option value="0">0 - Incapaz de realizar la actividad</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10 - Capaz de realizar la actividad al mismo nivel que antes</option>
              </select>
            </div>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-col form-col-md-12">
            <div class="resultado-container" id="psfs-resultado">
              <div class="resultado-label">Puntuación PSFS:</div>
              <div class="resultado-valor" id="psfs-valor">-</div>
              <div class="resultado-interpretacion" id="psfs-interpretacion">Complete al menos una actividad para obtener un resultado</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- GROC (Global Rating of Change) -->
    <div class="cuestionario-item">
      <div class="cuestionario-header" onclick="toggleCuestionario('groc-content')">
        <h4><i class="fas fa-plus-circle"></i> GROC (Global Rating of Change)</h4>
        <div class="resultado-badge" id="groc-badge">No completado</div>
      </div>
      <div class="cuestionario-content" id="groc-content" style="display: none;">
        <p class="mb-3">Esta escala evalúa la percepción del paciente sobre el cambio en su condición desde que comenzó el tratamiento.</p>
        
        <div class="form-row mb-3">
          <div class="form-col form-col-md-12">
            <div class="form-group">
              <label class="form-label">¿Cómo se siente ahora en comparación con cuando comenzó el tratamiento?</label>
              <div class="groc-scale-container">
                <div class="groc-scale">
                  <input type="radio" id="groc_-7" name="groc" value="-7" onchange="calcularGROC()">
                  <label for="groc_-7">-7<br>Extremadamente peor</label>
                  
                  <input type="radio" id="groc_-6" name="groc" value="-6" onchange="calcularGROC()">
                  <label for="groc_-6">-6</label>
                  
                  <input type="radio" id="groc_-5" name="groc" value="-5" onchange="calcularGROC()">
                  <label for="groc_-5">-5<br>Mucho peor</label>
                  
                  <input type="radio" id="groc_-4" name="groc" value="-4" onchange="calcularGROC()">
                  <label for="groc_-4">-4</label>
                  
                  <input type="radio" id="groc_-3" name="groc" value="-3" onchange="calcularGROC()">
                  <label for="groc_-3">-3<br>Moderadamente peor</label>
                  
                  <input type="radio" id="groc_-2" name="groc" value="-2" onchange="calcularGROC()">
                  <label for="groc_-2">-2</label>
                  
                  <input type="radio" id="groc_-1" name="groc" value="-1" onchange="calcularGROC()">
                  <label for="groc_-1">-1<br>Un poco peor</label>
                  
                  <input type="radio" id="groc_0" name="groc" value="0" onchange="calcularGROC()">
                  <label for="groc_0">0<br>Sin cambios</label>
                  
                  <input type="radio" id="groc_1" name="groc" value="1" onchange="calcularGROC()">
                  <label for="groc_1">+1<br>Un poco mejor</label>
                  
                  <input type="radio" id="groc_2" name="groc" value="2" onchange="calcularGROC()">
                  <label for="groc_2">+2</label>
                  
                  <input type="radio" id="groc_3" name="groc" value="3" onchange="calcularGROC()">
                  <label for="groc_3">+3<br>Moderadamente mejor</label>
                  
                  <input type="radio" id="groc_4" name="groc" value="4" onchange="calcularGROC()">
                  <label for="groc_4">+4</label>
                  
                  <input type="radio" id="groc_5" name="groc" value="5" onchange="calcularGROC()">
                  <label for="groc_5">+5<br>Mucho mejor</label>
                  
                  <input type="radio" id="groc_6" name="groc" value="6" onchange="calcularGROC()">
                  <label for="groc_6">+6</label>
                  
                  <input type="radio" id="groc_7" name="groc" value="7" onchange="calcularGROC()">
                  <label for="groc_7">+7<br>Completamente recuperado</label>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-col form-col-md-12">
            <div class="resultado-container" id="groc-resultado">
              <div class="resultado-label">Resultado GROC:</div>
              <div class="resultado-valor" id="groc-valor">-</div>
              <div class="resultado-interpretacion" id="groc-interpretacion">Seleccione una opción para obtener un resultado</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- SANE (Single Assessment Numeric Evaluation) -->
    <div class="cuestionario-item">
      <div class="cuestionario-header" onclick="toggleCuestionario('sane-content')">
        <h4><i class="fas fa-plus-circle"></i> SANE (Single Assessment Numeric Evaluation)</h4>
        <div class="resultado-badge" id="sane-badge">No completado</div>
      </div>
      <div class="cuestionario-content" id="sane-content" style="display: none;">
        <p class="mb-3">Una evaluación numérica única donde el paciente califica su función general en una escala de 0-100.</p>
        
        <div class="form-row mb-3">
          <div class="form-col form-col-md-12">
            <div class="form-group">
              <label for="sane_puntuacion" class="form-label">En una escala de 0 a 100, ¿cómo calificaría su [área afectada] hoy?</label>
              <p class="text-muted small mb-2">(0 = completamente incapacitado, 100 = normal)</p>
              <input type="range" id="sane_puntuacion" name="sane_puntuacion" class="form-range w-100" min="0" max="100" step="1" value="50" oninput="calcularSANE()">
              <div class="d-flex justify-content-between mt-1">
                <span>0</span>
                <span id="sane_puntuacion_value">50</span>
                <span>100</span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-col form-col-md-12">
            <div class="resultado-container" id="sane-resultado">
              <div class="resultado-label">Puntuación SANE:</div>
              <div class="resultado-valor" id="sane-valor">50%</div>
              <div class="resultado-interpretacion" id="sane-interpretacion">Función moderada</div>
            </div>
          </div>
        </div>
      </div>
    <!-- BPI (Inventario Breve de Dolor) -->
      <div class="cuestionario-item">
        <div class="cuestionario-header" onclick="toggleCuestionario('bpi-content')">
          <h4><i class="fas fa-plus-circle"></i> Inventario Breve de Dolor (BPI)</h4>
          <div class="resultado-badge" id="bpi-badge">No completado</div>
        </div>
        <div class="cuestionario-content" id="bpi-content" style="display: none;">
          <p class="mb-3">Este cuestionario evalúa la intensidad del dolor y su interferencia en las actividades diarias.</p>
          
          <h5>Parte 1: Intensidad del dolor</h5>
          <p class="text-muted small mb-2">Califique su dolor en una escala de 0 a 10 (0 = sin dolor, 10 = el peor dolor imaginable)</p>
          
          <div class="form-row mb-3">
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label for="bpi_dolor_actual" class="form-label">Dolor ahora mismo</label>
                <input type="range" id="bpi_dolor_actual" name="bpi_dolor_actual" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_dolor_actual_value').textContent = this.value; calcularBPI();">
                <div class="d-flex justify-content-between mt-1">
                  <span>0</span>
                  <span id="bpi_dolor_actual_value">0</span>
                  <span>10</span>
                </div>
              </div>
            </div>
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label for="bpi_dolor_promedio" class="form-label">Dolor promedio en las últimas 24 horas</label>
                <input type="range" id="bpi_dolor_promedio" name="bpi_dolor_promedio" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_dolor_promedio_value').textContent = this.value; calcularBPI();">
                <div class="d-flex justify-content-between mt-1">
                  <span>0</span>
                  <span id="bpi_dolor_promedio_value">0</span>
                  <span>10</span>
                </div>
              </div>
            </div>
          </div>
          
          <div class="form-row mb-3">
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label for="bpi_dolor_peor" class="form-label">Peor dolor en las últimas 24 horas</label>
                <input type="range" id="bpi_dolor_peor" name="bpi_dolor_peor" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_dolor_peor_value').textContent = this.value; calcularBPI();">
                <div class="d-flex justify-content-between mt-1">
                  <span>0</span>
                  <span id="bpi_dolor_peor_value">0</span>
                  <span>10</span>
                </div>
              </div>
            </div>
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label for="bpi_dolor_menor" class="form-label">Menor dolor en las últimas 24 horas</label>
                <input type="range" id="bpi_dolor_menor" name="bpi_dolor_menor" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_dolor_menor_value').textContent = this.value; calcularBPI();">
                <div class="d-flex justify-content-between mt-1">
                  <span>0</span>
                  <span id="bpi_dolor_menor_value">0</span>
                  <span>10</span>
                </div>
              </div>
            </div>
          </div>
          
          <h5 class="mt-4">Parte 2: Interferencia del dolor</h5>
          <p class="text-muted small mb-2">Califique cómo el dolor ha interferido en las siguientes actividades en una escala de 0 a 10 (0 = no interfiere, 10 = interfiere completamente)</p>
          
          <div class="form-row mb-3">
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label for="bpi_interferencia_actividad" class="form-label">Actividad general</label>
                <input type="range" id="bpi_interferencia_actividad" name="bpi_interferencia_actividad" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_actividad_value').textContent = this.value; calcularBPI();">
                <div class="d-flex justify-content-between mt-1">
                  <span>0</span>
                  <span id="bpi_interferencia_actividad_value">0</span>
                  <span>10</span>
                </div>
              </div>
            </div>
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label for="bpi_interferencia_animo" class="form-label">Estado de ánimo</label>
                <input type="range" id="bpi_interferencia_animo" name="bpi_interferencia_animo" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_animo_value').textContent = this.value; calcularBPI();">
                <div class="d-flex justify-content-between mt-1">
                  <span>0</span>
                  <span id="bpi_interferencia_animo_value">0</span>
                  <span>10</span>
                </div>
              </div>
            </div>
          </div>
          
          <div class="form-row mb-3">
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label for="bpi_interferencia_caminar" class="form-label">Capacidad para caminar</label>
                <input type="range" id="bpi_interferencia_caminar" name="bpi_interferencia_caminar" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_caminar_value').textContent = this.value; calcularBPI();">
                <div class="d-flex justify-content-between mt-1">
                  <span>0</span>
                  <span id="bpi_interferencia_caminar_value">0</span>
                  <span>10</span>
                </div>
              </div>
            </div>
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label for="bpi_interferencia_trabajo" class="form-label">Trabajo habitual</label>
                <input type="range" id="bpi_interferencia_trabajo" name="bpi_interferencia_trabajo" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_trabajo_value').textContent = this.value; calcularBPI();">
                <div class="d-flex justify-content-between mt-1">
                  <span>0</span>
                  <span id="bpi_interferencia_trabajo_value">0</span>
                  <span>10</span>
                </div>
              </div>
            </div>
          </div>
          
          <div class="form-row mb-3">
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label for="bpi_interferencia_relaciones" class="form-label">Relaciones con otras personas</label>
                <input type="range" id="bpi_interferencia_relaciones" name="bpi_interferencia_relaciones" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_relaciones_value').textContent = this.value; calcularBPI();">
                <div class="d-flex justify-content-between mt-1">
                  <span>0</span>
                  <span id="bpi_interferencia_relaciones_value">0</span>
                  <span>10</span>
                </div>
              </div>
            </div>
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label for="bpi_interferencia_sueno" class="form-label">Sueño</label>
                <input type="range" id="bpi_interferencia_sueno" name="bpi_interferencia_sueno" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_sueno_value').textContent = this.value; calcularBPI();">
                <div class="d-flex justify-content-between mt-1">
                  <span>0</span>
                  <span id="bpi_interferencia_sueno_value">0</span>
                  <span>10</span>
                </div>
              </div>
            </div>
          </div>
          
          <div class="form-row mb-3">
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label for="bpi_interferencia_vida" class="form-label">Capacidad de disfrutar de la vida</label>
                <input type="range" id="bpi_interferencia_vida" name="bpi_interferencia_vida" class="form-range w-100" min="0" max="10" step="1" value="0" oninput="document.getElementById('bpi_interferencia_vida_value').textContent = this.value; calcularBPI();">
                <div class="d-flex justify-content-between mt-1">
                  <span>0</span>
                  <span id="bpi_interferencia_vida_value">0</span>
                  <span>10</span>
                </div>
              </div>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-col form-col-md-12">
              <div class="resultado-container" id="bpi-resultado">
                <div class="resultado-label">Resultados BPI:</div>
                <div class="form-row">
                  <div class="form-col form-col-md-6">
                    <div class="resultado-sublabel">Intensidad del dolor:</div>
                    <div class="resultado-valor" id="bpi-intensidad-valor">0/10</div>
                    <div class="resultado-interpretacion" id="bpi-intensidad-interpretacion">Sin dolor</div>
                  </div>
                  <div class="form-col form-col-md-6">
                    <div class="resultado-sublabel">Interferencia del dolor:</div>
                    <div class="resultado-valor" id="bpi-interferencia-valor">0/10</div>
                    <div class="resultado-interpretacion" id="bpi-interferencia-interpretacion">Sin interferencia</div>
                  </div>
                </div>
                
                <div class="interpretacion-clinica-container">
                  <h5>Interpretación Clínica:</h5>
                  <div class="interpretacion-clinica" id="bpi-interpretacion-clinica">
                    Complete el cuestionario para obtener la interpretación clínica.
                  </div>
                </div>
                
                <div class="recomendaciones-container">
                  <h5>Recomendaciones Terapéuticas:</h5>
                  <div class="recomendaciones" id="bpi-recomendaciones">
                    Complete el cuestionario para obtener recomendaciones terapéuticas.
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- PCS (Escala de Catastrofización ante el Dolor) -->
<div class="cuestionario-item">
  <div class="cuestionario-header" onclick="toggleCuestionario('pcs-content')">
    <h4><i class="fas fa-plus-circle"></i> Escala de Catastrofización ante el Dolor (PCS)</h4>
    <div class="resultado-badge" id="pcs-badge">No completado</div>
  </div>
  <div class="cuestionario-content" id="pcs-content" style="display: none;">
    <p class="mb-3">Este cuestionario evalúa los pensamientos y sentimientos catastróficos asociados con el dolor. Indique el grado en que experimenta cada uno de estos pensamientos o sentimientos cuando siente dolor.</p>
    
    <table class="table table-bordered mb-4">
      <thead>
        <tr>
          <th>Cuando siento dolor...</th>
          <th>Nada</th>
          <th>Leve</th>
          <th>Moderado</th>
          <th>Intenso</th>
          <th>Todo el tiempo</th>
        </tr>
      </thead>
      <tbody>
        <!-- Rumiación -->
        <tr>
          <td>1. Estoy preocupado todo el tiempo pensando en si el dolor desaparecerá</td>
          <td class="text-center"><input type="radio" name="pcs_item1" value="0" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item1" value="1" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item1" value="2" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item1" value="3" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item1" value="4" onchange="calcularPCS()"></td>
        </tr>
        <tr>
          <td>2. Siento que no puedo continuar</td>
          <td class="text-center"><input type="radio" name="pcs_item2" value="0" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item2" value="1" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item2" value="2" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item2" value="3" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item2" value="4" onchange="calcularPCS()"></td>
        </tr>
        <tr>
          <td>3. Es terrible y pienso que esto nunca va a mejorar</td>
          <td class="text-center"><input type="radio" name="pcs_item3" value="0" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item3" value="1" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item3" value="2" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item3" value="3" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item3" value="4" onchange="calcularPCS()"></td>
        </tr>
        <tr>
          <td>4. Es horrible y siento que esto me supera</td>
          <td class="text-center"><input type="radio" name="pcs_item4" value="0" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item4" value="1" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item4" value="2" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item4" value="3" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item4" value="4" onchange="calcularPCS()"></td>
        </tr>
        
        <!-- Magnificación -->
        <tr>
          <td>5. Siento que no puedo soportarlo más</td>
          <td class="text-center"><input type="radio" name="pcs_item5" value="0" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item5" value="1" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item5" value="2" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item5" value="3" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item5" value="4" onchange="calcularPCS()"></td>
        </tr>
        <tr>
          <td>6. Temo que el dolor empeore</td>
          <td class="text-center"><input type="radio" name="pcs_item6" value="0" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item6" value="1" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item6" value="2" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item6" value="3" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item6" value="4" onchange="calcularPCS()"></td>
        </tr>
        <tr>
          <td>7. Sigo pensando en otras situaciones dolorosas</td>
          <td class="text-center"><input type="radio" name="pcs_item7" value="0" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item7" value="1" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item7" value="2" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item7" value="3" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item7" value="4" onchange="calcularPCS()"></td>
        </tr>
        
        <!-- Desesperanza -->
        <tr>
          <td>8. Deseo desesperadamente que desaparezca el dolor</td>
          <td class="text-center"><input type="radio" name="pcs_item8" value="0" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item8" value="1" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item8" value="2" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item8" value="3" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item8" value="4" onchange="calcularPCS()"></td>
        </tr>
        <tr>
          <td>9. No puedo apartar el dolor de mi mente</td>
          <td class="text-center"><input type="radio" name="pcs_item9" value="0" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item9" value="1" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item9" value="2" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item9" value="3" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item9" value="4" onchange="calcularPCS()"></td>
        </tr>
        <tr>
          <td>10. Sigo pensando en lo mucho que me duele</td>
          <td class="text-center"><input type="radio" name="pcs_item10" value="0" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item10" value="1" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item10" value="2" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item10" value="3" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item10" value="4" onchange="calcularPCS()"></td>
        </tr>
        <tr>
          <td>11. Sigo pensando en lo mucho que deseo que desaparezca el dolor</td>
          <td class="text-center"><input type="radio" name="pcs_item11" value="0" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item11" value="1" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item11" value="2" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item11" value="3" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item11" value="4" onchange="calcularPCS()"></td>
        </tr>
        <tr>
          <td>12. No hay nada que pueda hacer para reducir la intensidad del dolor</td>
          <td class="text-center"><input type="radio" name="pcs_item12" value="0" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item12" value="1" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item12" value="2" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item12" value="3" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item12" value="4" onchange="calcularPCS()"></td>
        </tr>
        <tr>
          <td>13. Me pregunto si me puede pasar algo grave</td>
          <td class="text-center"><input type="radio" name="pcs_item13" value="0" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item13" value="1" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item13" value="2" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item13" value="3" onchange="calcularPCS()"></td>
          <td class="text-center"><input type="radio" name="pcs_item13" value="4" onchange="calcularPCS()"></td>
        </tr>
      </tbody>
    </table>
    
    <div class="form-row">
      <div class="form-col form-col-md-12">
        <div class="resultado-container" id="pcs-resultado">
          <div class="form-row">
            <div class="form-col form-col-md-4">
              <div class="resultado-label">Puntuación Total:</div>
              <div class="resultado-valor" id="pcs-valor-total">-/52</div>
              <div class="resultado-interpretacion" id="pcs-interpretacion-total">Complete el cuestionario</div>
            </div>
            <div class="form-col form-col-md-8">
              <div class="resultado-label">Subescalas:</div>
              <div class="form-row">
                <div class="form-col form-col-md-4">
                  <div class="resultado-sublabel">Rumiación:</div>
                  <div class="resultado-valor" id="pcs-valor-rumiacion">-/16</div>
                </div>
                <div class="form-col form-col-md-4">
                  <div class="resultado-sublabel">Magnificación:</div>
                  <div class="resultado-valor" id="pcs-valor-magnificacion">-/12</div>
                </div>
                <div class="form-col form-col-md-4">
                  <div class="resultado-sublabel">Desesperanza:</div>
                  <div class="resultado-valor" id="pcs-valor-desesperanza">-/24</div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="interpretacion-clinica-container mt-3">
            <h5>Interpretación Clínica:</h5>
            <div class="interpretacion-clinica" id="pcs-interpretacion-clinica">
              Complete el cuestionario para obtener la interpretación clínica.
            </div>
          </div>
          
          <div class="recomendaciones-container mt-3">
            <h5>Recomendaciones Terapéuticas:</h5>
            <div class="recomendaciones" id="pcs-recomendaciones">
              Complete el cuestionario para obtener recomendaciones terapéuticas.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
      
      <!-- DN4 (Cuestionario de Dolor Neuropático) -->
      <div class="cuestionario-item">
        <div class="cuestionario-header" onclick="toggleCuestionario('dn4-content')">
          <h4><i class="fas fa-plus-circle"></i> Cuestionario de Dolor Neuropático (DN4)</h4>
          <div class="resultado-badge" id="dn4-badge">No completado</div>
        </div>
        <div class="cuestionario-content" id="dn4-content" style="display: none;">
          <p class="mb-3">Este cuestionario ayuda a identificar el dolor neuropático. Responda Sí o No a las siguientes preguntas basadas en las características del dolor del paciente.</p>
          
          <h5>Parte 1: Entrevista al paciente</h5>
          <p class="text-muted small mb-2">¿El dolor tiene una o más de las siguientes características?</p>
          
          <div class="form-row mb-3">
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label class="form-label">1. ¿Quemazón?</label>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_quemazon" id="dn4_quemazon_si" value="1" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_quemazon_si">Sí</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_quemazon" id="dn4_quemazon_no" value="0" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_quemazon_no">No</label>
                </div>
              </div>
            </div>
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label class="form-label">2. ¿Sensación de frío doloroso?</label>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_frio" id="dn4_frio_si" value="1" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_frio_si">Sí</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_frio" id="dn4_frio_no" value="0" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_frio_no">No</label>
                </div>
              </div>
            </div>
          </div>
          
          <div class="form-row mb-3">
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label class="form-label">3. ¿Descargas eléctricas?</label>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_descargas" id="dn4_descargas_si" value="1" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_descargas_si">Sí</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_descargas" id="dn4_descargas_no" value="0" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_descargas_no">No</label>
                </div>
              </div>
            </div>
          </div>
          
          <h5 class="mt-4">¿Se asocia el dolor con uno o más de los siguientes síntomas en la misma zona?</h5>
          
          <div class="form-row mb-3">
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label class="form-label">4. ¿Hormigueo?</label>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_hormigueo" id="dn4_hormigueo_si" value="1" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_hormigueo_si">Sí</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_hormigueo" id="dn4_hormigueo_no" value="0" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_hormigueo_no">No</label>
                </div>
              </div>
            </div>
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label class="form-label">5. ¿Alfileres y agujas?</label>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_alfileres" id="dn4_alfileres_si" value="1" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_alfileres_si">Sí</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_alfileres" id="dn4_alfileres_no" value="0" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_alfileres_no">No</label>
                </div>
              </div>
            </div>
          </div>
          
          <div class="form-row mb-3">
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label class="form-label">6. ¿Entumecimiento?</label>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_entumecimiento" id="dn4_entumecimiento_si" value="1" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_entumecimiento_si">Sí</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_entumecimiento" id="dn4_entumecimiento_no" value="0" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_entumecimiento_no">No</label>
                </div>
              </div>
            </div>
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label class="form-label">7. ¿Picazón?</label>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_picazon" id="dn4_picazon_si" value="1" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_picazon_si">Sí</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_picazon" id="dn4_picazon_no" value="0" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_picazon_no">No</label>
                </div>
              </div>
            </div>
          </div>
          
          <h5 class="mt-4">Parte 2: Examen del paciente</h5>
          <p class="text-muted small mb-2">¿El dolor está localizado en una zona donde el examen físico puede mostrar una o más de las siguientes características?</p>
          
          <div class="form-row mb-3">
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label class="form-label">8. ¿Hipoestesia al tacto?</label>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_hipoestesia" id="dn4_hipoestesia_si" value="1" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_hipoestesia_si">Sí</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_hipoestesia" id="dn4_hipoestesia_no" value="0" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_hipoestesia_no">No</label>
                </div>
              </div>
            </div>
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label class="form-label">9. ¿Hipoestesia al pinchazo?</label>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_hipoestesia_pinchazo" id="dn4_hipoestesia_pinchazo_si" value="1" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_hipoestesia_pinchazo_si">Sí</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_hipoestesia_pinchazo" id="dn4_hipoestesia_pinchazo_no" value="0" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_hipoestesia_pinchazo_no">No</label>
                </div>
              </div>
            </div>
          </div>
          
          <div class="form-row mb-3">
            <div class="form-col form-col-md-6">
              <div class="form-group">
                <label class="form-label">10. ¿Se provoca o incrementa el dolor por cepillado?</label>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_cepillado" id="dn4_cepillado_si" value="1" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_cepillado_si">Sí</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="dn4_cepillado" id="dn4_cepillado_no" value="0" onchange="calcularDN4()">
                  <label class="form-check-label" for="dn4_cepillado_no">No</label>
                </div>
              </div>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-col form-col-md-12">
              <div class="resultado-container" id="dn4-resultado">
                <div class="resultado-label">Puntuación DN4:</div>
                <div class="resultado-valor" id="dn4-valor">0/10</div>
                <div class="resultado-interpretacion" id="dn4-interpretacion">Complete el cuestionario para obtener un resultado</div>
                
                <div class="interpretacion-clinica-container">
                  <h5>Interpretación Clínica:</h5>
                  <div class="interpretacion-clinica" id="dn4-interpretacion-clinica">
                    Complete el cuestionario para obtener la interpretación clínica.
                  </div>
                </div>
                
                <div class="recomendaciones-container">
                  <h5>Recomendaciones Terapéuticas:</h5>
                  <div class="recomendaciones" id="dn4-recomendaciones">
                    Complete el cuestionario para obtener recomendaciones terapéuticas.
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div> <!-- Cierre de cuestionario-item para DN4 -->
    </div> <!-- Cierre de cuestionarios-acordeon -->

    <div class="form-row mt-4">
          <div class="form-col form-col-md-12">
            <button type="button" class="btn btn-secondary prev-tab" data-prev="motivo-consulta"><i class="fas fa-arrow-left"></i> Anterior</button>
            <button type="button" class="btn btn-primary next-tab" data-next="historia-medica">Siguiente <i class="fas fa-arrow-right"></i></button>
          </div>
        </div>
      </div> <!-- Cierre de tab-content cuestionarios -->
          
          <!-- 4. Historia Médica -->
          <div class="tab-content" id="historia-medica">
            <h3>4. Historia Médica Detallada</h3>
            
            <h4>4.1 Antecedentes Personales</h4>
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="enfermedadesCronicas" class="form-label">Enfermedades crónicas</label>
                  <textarea id="enfermedadesCronicas" name="enfermedadesCronicas" class="form-control" rows="2"></textarea>
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="enfermedadesAgudas" class="form-label">Enfermedades agudas previas</label>
                  <textarea id="enfermedadesAgudas" name="enfermedadesAgudas" class="form-control" rows="2"></textarea>
                </div>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="hospitalizaciones" class="form-label">Hospitalizaciones</label>
                  <textarea id="hospitalizaciones" name="hospitalizaciones" class="form-control" rows="2"></textarea>
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="cirugiasPrevias" class="form-label">Cirugías previas</label>
                  <textarea id="cirugiasPrevias" name="cirugiasPrevias" class="form-control" rows="2"></textarea>
                </div>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="antecedentesOrtopedicos" class="form-label">Antecedentes ortopédicos/musculoesqueléticos previos</label>
                  <textarea id="antecedentesOrtopedicos" name="antecedentesOrtopedicos" class="form-control" rows="2"></textarea>
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="traumatismosPrevios" class="form-label">Traumatismos previos</label>
                  <textarea id="traumatismosPrevios" name="traumatismosPrevios" class="form-control" rows="2"></textarea>
                </div>
              </div>
            </div>
            
            <h4>4.2 Antecedentes Familiares</h4>
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="enfermedadesHereditarias" class="form-label">Enfermedades hereditarias</label>
                  <textarea id="enfermedadesHereditarias" name="enfermedadesHereditarias" class="form-control" rows="2"></textarea>
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="condicionesGeneticas" class="form-label">Condiciones genéticas relevantes</label>
                  <textarea id="condicionesGeneticas" name="condicionesGeneticas" class="form-control" rows="2"></textarea>
                </div>
              </div>
            </div>
            
            <h4>4.3 Medicación Actual</h4>
            <div class="form-row">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <label for="medicamentosActuales" class="form-label">Medicamentos actuales</label>
                  <textarea id="medicamentosActuales" name="medicamentosActuales" class="form-control" rows="3"></textarea>
                </div>
              </div>
            </div>
            
            <h4>4.4 Alergias e Hipersensibilidades</h4>
            <div class="form-row">
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="alergiasMedicamentos" class="form-label">Medicamentos</label>
                  <textarea id="alergiasMedicamentos" name="alergiasMedicamentos" class="form-control" rows="2"></textarea>
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="alergiasAlimentos" class="form-label">Alimentos</label>
                  <textarea id="alergiasAlimentos" name="alergiasAlimentos" class="form-control" rows="2"></textarea>
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="alergiasAmbientales" class="form-label">Ambientales</label>
                  <textarea id="alergiasAmbientales" name="alergiasAmbientales" class="form-control" rows="2"></textarea>
                </div>
              </div>
            </div>
            
            <div class="form-row mt-4">
              <div class="form-col form-col-md-12">
                <button type="button" class="btn btn-secondary prev-tab" data-prev="cuestionarios"><i class="fas fa-arrow-left"></i> Anterior</button>
                <button type="button" class="btn btn-primary next-tab" data-next="habitos">Siguiente <i class="fas fa-arrow-right"></i></button>
              </div>
            </div>
          </div>
          
          <!-- 5. Hábitos -->
          <div class="tab-content" id="habitos">
            <h3>5. Evaluación de Hábitos y Estilo de Vida</h3>
            
            <h4>5.1 Hábitos Nutricionales</h4>
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="tipoDieta" class="form-label">Tipo de dieta</label>
                  <input type="text" id="tipoDieta" name="tipoDieta" class="form-control">
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="consumoAgua" class="form-label">Consumo de agua</label>
                  <input type="text" id="consumoAgua" name="consumoAgua" class="form-control">
                </div>
              </div>
            </div>
            
            <h4>5.2 Hábitos Tóxicos</h4>
            <div class="form-row">
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="consumoTabaco" class="form-label">Consumo de tabaco</label>
                  <textarea id="consumoTabaco" name="consumoTabaco" class="form-control" rows="2"></textarea>
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="consumoAlcohol" class="form-label">Consumo de alcohol</label>
                  <textarea id="consumoAlcohol" name="consumoAlcohol" class="form-control" rows="2"></textarea>
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="consumoDrogas" class="form-label">Consumo de drogas</label>
                  <textarea id="consumoDrogas" name="consumoDrogas" class="form-control" rows="2"></textarea>
                </div>
              </div>
            </div>
            
            <h4>5.3 Actividad Física y Deportiva</h4>
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="practicaDeportes" class="form-label">Práctica de deportes</label>
                  <textarea id="practicaDeportes" name="practicaDeportes" class="form-control" rows="2"></textarea>
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="frecuenciaDeporte" class="form-label">Frecuencia</label>
                  <select id="frecuenciaDeporte" name="frecuenciaDeporte" class="form-select">
                    <option value="">Seleccionar</option>
                    <option value="Diaria">Diaria</option>
                    <option value="4-6 veces/semana">4-6 veces/semana</option>
                    <option value="2-3 veces/semana">2-3 veces/semana</option>
                    <option value="1 vez/semana">1 vez/semana</option>
                    <option value="Ocasional">Ocasional</option>
                    <option value="Nunca">Nunca</option>
                  </select>
                </div>
              </div>
            </div>
            
            <h4>5.4 Patrón de Sueño</h4>
            <div class="form-row">
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="horasSueno" class="form-label">Horas de sueño</label>
                  <input type="number" id="horasSueno" name="horasSueno" class="form-control" min="0" max="24">
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="calidadSueno" class="form-label">Calidad del sueño</label>
                  <select id="calidadSueno" name="calidadSueno" class="form-select">
                    <option value="">Seleccionar</option>
                    <option value="Buena">Buena</option>
                    <option value="Regular">Regular</option>
                    <option value="Mala">Mala</option>
                  </select>
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="problemasSueno" class="form-label">Problemas de sueño</label>
                  <textarea id="problemasSueno" name="problemasSueno" class="form-control" rows="2"></textarea>
                </div>
              </div>
            </div>
            
            <div class="form-row mt-4">
              <div class="form-col form-col-md-12">
                <button type="button" class="btn btn-secondary prev-tab" data-prev="historia-medica"><i class="fas fa-arrow-left"></i> Anterior</button>
                <button type="button" class="btn btn-primary next-tab" data-next="evaluacion-fisica">Siguiente <i class="fas fa-arrow-right"></i></button>
              </div>
            </div>
          </div>
          
          <!-- 6. Evaluación Física -->
          <div class="tab-content" id="evaluacion-fisica">
            <h3>6. Evaluación Física Completa</h3>
            
            <h4>6.1 Signos Vitales</h4>
            <div class="form-row">
              <div class="form-col form-col-md-3">
                <div class="form-group">
                  <label for="frecuenciaCardiaca" class="form-label">Frecuencia cardíaca (lpm)</label>
                  <input type="number" id="frecuenciaCardiaca" name="frecuenciaCardiaca" class="form-control" min="0" max="250">
                </div>
              </div>
              <div class="form-col form-col-md-3">
                <div class="form-group">
                  <label for="frecuenciaRespiratoria" class="form-label">Frecuencia respiratoria (rpm)</label>
                  <input type="number" id="frecuenciaRespiratoria" name="frecuenciaRespiratoria" class="form-control" min="0" max="100">
                </div>
              </div>
              <div class="form-col form-col-md-3">
                <div class="form-group">
                  <label for="presionArterial" class="form-label">Presión arterial (mmHg)</label>
                  <input type="text" id="presionArterial" name="presionArterial" class="form-control" placeholder="Ej: 120/80">
                </div>
              </div>
              <div class="form-col form-col-md-3">
                <div class="form-group">
                  <label for="saturacionOxigeno" class="form-label">Saturación de oxígeno (%)</label>
                  <input type="number" id="saturacionOxigeno" name="saturacionOxigeno" class="form-control" min="0" max="100">
                </div>
              </div>
            </div>
            
            <h4>6.2 Antropometría</h4>
            <div class="form-row">
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="peso" class="form-label">Peso (kg)</label>
                  <input type="number" id="peso" name="peso" class="form-control" min="0" max="500" step="0.1">
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="talla" class="form-label">Talla (cm)</label>
                  <input type="number" id="talla" name="talla" class="form-control" min="0" max="300">
                </div>
              </div>
              <div class="form-col form-col-md-4">
                <div class="form-group">
                  <label for="imc" class="form-label">IMC (kg/m²)</label>
                  <input type="number" id="imc" name="imc" class="form-control" min="0" max="100" step="0.01" readonly>
                </div>
              </div>
            </div>
            
            <h4>6.3 Evaluación Postural</h4>
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="alineacionCorporal" class="form-label">Alineación corporal</label>
                  <textarea id="alineacionCorporal" name="alineacionCorporal" class="form-control" rows="2"></textarea>
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="alteracionesPosturales" class="form-label">Alteraciones posturales</label>
                  <textarea id="alteracionesPosturales" name="alteracionesPosturales" class="form-control" rows="2"></textarea>
                </div>
              </div>
            </div>
            
            <h4>6.4 Evaluación Física</h4>
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="inspeccion" class="form-label">Inspección</label>
                  <textarea id="inspeccion" name="inspeccion" class="form-control" rows="2"></textarea>
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="palpacion" class="form-label">Palpación</label>
                  <textarea id="palpacion" name="palpacion" class="form-control" rows="2"></textarea>
                </div>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <label for="rangoMovimiento" class="form-label">Rango de movimiento articular</label>
                  <textarea id="rangoMovimiento" name="rangoMovimiento" class="form-control" rows="3"></textarea>
                </div>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <label for="fuerzaMuscular" class="form-label">Fuerza muscular</label>
                  <textarea id="fuerzaMuscular" name="fuerzaMuscular" class="form-control" rows="3"></textarea>
                </div>
              </div>
            </div>
            
            <div class="form-row mt-4">
              <div class="form-col form-col-md-12">
                <button type="button" class="btn btn-secondary prev-tab" data-prev="habitos"><i class="fas fa-arrow-left"></i> Anterior</button>
                <button type="button" class="btn btn-primary next-tab" data-next="escalas">Siguiente <i class="fas fa-arrow-right"></i></button>
              </div>
            </div>
          </div>
          
          <!-- 7. Escalas -->
          <div class="tab-content" id="escalas">
            <h3>7. Escalas y Cuestionarios Estandarizados</h3>
            
            <h4>7.1 Escalas de Dolor</h4>
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="escalaEVA" class="form-label">EVA (Escala Visual Analógica)</label>
                  <input type="range" id="escalaEVA" name="escalaEVA" class="form-range" min="0" max="10" step="1" value="0" oninput="document.getElementById('escalaEVA_value').textContent = this.value;">
                  <div class="d-flex justify-content-between">
                    <span>0 (Sin dolor)</span>
                    <span id="escalaEVA_value">0</span>
                    <span>10 (Máximo dolor)</span>
                  </div>
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="escalaNumerica" class="form-label">Escala Numérica</label>
                  <select id="escalaNumerica" name="escalaNumerica" class="form-select">
                    <option value="">Seleccionar</option>
                    <option value="0">0 - Sin dolor</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10 - Máximo dolor</option>
                  </select>
                </div>
              </div>
            </div>
            
            <h4>7.2 Escalas Funcionales</h4>
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="escalaPSFS" class="form-label">PSFS (Patient-Specific Functional Scale)</label>
                  <textarea id="escalaPSFS" name="escalaPSFS" class="form-control" rows="2"></textarea>
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="escalaGROC" class="form-label">GROC (Global Rating of Change)</label>
                  <textarea id="escalaGROC" name="escalaGROC" class="form-control" rows="2"></textarea>
                </div>
              </div>
            </div>
            
            <h4>7.3 Cuestionarios Específicos</h4>
            <div class="form-row">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <label for="cuestionariosEspecificos" class="form-label">Cuestionarios aplicados</label>
                  <textarea id="cuestionariosEspecificos" name="cuestionariosEspecificos" class="form-control" rows="3"></textarea>
                </div>
              </div>
            </div>
            
            <div class="form-row mt-4">
              <div class="form-col form-col-md-12">
                <button type="button" class="btn btn-secondary prev-tab" data-prev="evaluacion-fisica"><i class="fas fa-arrow-left"></i> Anterior</button>
                <button type="button" class="btn btn-primary next-tab" data-next="banderas">Siguiente <i class="fas fa-arrow-right"></i></button>
              </div>
            </div>
          </div>
          
          <!-- 8. Banderas -->
          <div class="tab-content" id="banderas">
            <h3>8. Sistema de Banderas de Alerta</h3>
            
            <h4>8.1 Banderas Rojas (Riesgo Físico)</h4>
            <div class="form-row">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <textarea id="banderasRojas" name="banderasRojas" class="form-control" rows="3" placeholder="Describir si existen banderas rojas: dolor severo, síntomas neurológicos, antecedentes de cáncer, etc."></textarea>
                </div>
              </div>
            </div>
            
            <h4>8.2 Banderas Amarillas (Factores Psicosociales)</h4>
            <div class="form-row">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <textarea id="banderasAmarillas" name="banderasAmarillas" class="form-control" rows="3" placeholder="Describir si existen banderas amarillas: miedo-evitación, catastrofización, creencias erróneas sobre el dolor, etc."></textarea>
                </div>
              </div>
            </div>
            
            <h4>8.3 Banderas Azules (Factores Laborales)</h4>
            <div class="form-row">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <textarea id="banderasAzules" name="banderasAzules" class="form-control" rows="3" placeholder="Describir si existen banderas azules: trabajo físicamente demandante, baja satisfacción laboral, conflictos laborales, etc."></textarea>
                </div>
              </div>
            </div>
            
            <h4>8.4 Banderas Negras (Factores Contextuales)</h4>
            <div class="form-row">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <textarea id="banderasNegras" name="banderasNegras" class="form-control" rows="3" placeholder="Describir si existen banderas negras: compensaciones, litigios, problemas de acceso a servicios de salud, etc."></textarea>
                </div>
              </div>
            </div>
            
            <div class="form-row mt-4">
              <div class="form-col form-col-md-12">
                <button type="button" class="btn btn-secondary prev-tab" data-prev="escalas"><i class="fas fa-arrow-left"></i> Anterior</button>
                <button type="button" class="btn btn-primary next-tab" data-next="documentos">Siguiente <i class="fas fa-arrow-right"></i></button>
              </div>
            </div>
          </div>
          
          <!-- 9. Documentos -->
          <div class="tab-content" id="documentos">
            <h3>9. Documentación Complementaria</h3>
            <p>Esta sección será habilitada posteriormente cuando el paciente haya sido guardado.</p>
            
            <div class="form-row mt-4">
              <div class="form-col form-col-md-12">
                <button type="button" class="btn btn-secondary prev-tab" data-prev="banderas"><i class="fas fa-arrow-left"></i> Anterior</button>
                <button type="button" class="btn btn-primary next-tab" data-next="plan">Siguiente <i class="fas fa-arrow-right"></i></button>
              </div>
            </div>
          </div>
          
          <!-- 10. Plan de Tratamiento -->
          <div class="tab-content" id="plan">
            <h3>10. Plan de Tratamiento Inicial</h3>
            
            <div class="form-row">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <label for="objetivosTerapeuticos" class="form-label">Objetivos terapéuticos</label>
                  <textarea id="objetivosTerapeuticos" name="objetivosTerapeuticos" class="form-control" rows="3"></textarea>
                </div>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-col form-col-md-12">
                <div class="form-group">
                  <label for="intervencionesProuestas" class="form-label">Intervenciones propuestas</label>
                  <textarea id="intervencionesProuestas" name="intervencionesProuestas" class="form-control" rows="3"></textarea>
                </div>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="frecuenciaTratamiento" class="form-label">Frecuencia de tratamiento</label>
                  <input type="text" id="frecuenciaTratamiento" name="frecuenciaTratamiento" class="form-control">
                </div>
              </div>
              <div class="form-col form-col-md-6">
                <div class="form-group">
                  <label for="pronosticoInicial" class="form-label">Pronóstico inicial</label>
                  <input type="text" id="pronosticoInicial" name="pronosticoInicial" class="form-control">
                </div>
              </div>
            </div>
            
            <div class="form-row mt-4">
              <div class="form-col form-col-md-12">
                <button type="button" class="btn btn-secondary prev-tab" data-prev="documentos"><i class="fas fa-arrow-left"></i> Anterior</button>
                <button type="button" id="save-patient-btn" class="btn btn-success"><i class="fas fa-save"></i> Guardar Paciente</button>
              </div>
            </div>
          </div>
          
        </form>
      </div>
    </div>
  </main>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
  
  <!-- Custom Scripts -->
  <script src="js/firebase-config.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/pacientes.js"></script>
  <script>
    // Obtener ID del paciente de la URL (para edición)
    const urlParams = new URLSearchParams(window.location.search);
    const patientId = urlParams.get('id');
    let isEditMode = !!patientId;
    
    // Inicializar página
    document.addEventListener('DOMContentLoaded', function() {
      // Verificar autenticación
      verificarAutenticacion().then(user => {
        if (!user) {
          window.location.href = 'index.html';
        } else if (isEditMode) {
          // Cargar datos del paciente para edición
          cargarPacienteParaEditar(patientId);
        }
      });
      
      // Event listeners para navegación de pestañas
      document.querySelectorAll('.tab-link').forEach(tab => {
        tab.addEventListener('click', function() {
          const tabId = this.getAttribute('data-tab');
          activarTab(tabId);
        });
      });
      
      // Event listeners para botones de navegación
      document.querySelectorAll('.next-tab').forEach(btn => {
        btn.addEventListener('click', function() {
          const nextTabId = this.getAttribute('data-next');
          activarTab(nextTabId);
        });
      });
      
      document.querySelectorAll('.prev-tab').forEach(btn => {
        btn.addEventListener('click', function() {
          const prevTabId = this.getAttribute('data-prev');
          activarTab(prevTabId);
        });
      });
      
      // Event listener para calcular IMC
      document.getElementById('peso').addEventListener('input', calcularIMC);
      document.getElementById('talla').addEventListener('input', calcularIMC);
      
      // Event listener para guardar paciente
      document.getElementById('save-patient-btn').addEventListener('click', guardarPacienteForm);
      
      // Event listener para cerrar sesión
      document.getElementById('logout-btn').addEventListener('click', function(e) {
        e.preventDefault();
        cerrarSesion().then(() => {
          window.location.href = 'index.html';
        });
      });
    });
    
    // Función para activar una pestaña
    function activarTab(tabId) {
      // Ocultar todas las pestañas
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });
      
      // Desactivar todos los enlaces de pestañas
      document.querySelectorAll('.tab-link').forEach(link => {
        link.classList.remove('active');
      });
      
      // Activar la pestaña seleccionada
      document.getElementById(tabId).classList.add('active');
      
      // Activar el enlace seleccionado
      document.querySelector(`.tab-link[data-tab="${tabId}"]`).classList.add('active');
      
      // Scroll al inicio
      window.scrollTo(0, 0);
    }
    
    // Función para calcular IMC
    function calcularIMC() {
      const peso = parseFloat(document.getElementById('peso').value);
      const talla = parseFloat(document.getElementById('talla').value);
      
      if (peso && talla) {
        const tallaMt = talla / 100; // Convertir cm a m
        const imc = peso / (tallaMt * tallaMt);
        document.getElementById('imc').value = imc.toFixed(2);
      } else {
        document.getElementById('imc').value = '';
      }
    }
    
    // Función para cargar datos del paciente para edición
    function cargarPacienteParaEditar(patientId) {
      // Mostrar mensaje de carga
      document.getElementById('loading-form').style.display = 'block';
      document.getElementById('patient-form').style.display = 'none';
      
      // Actualizar título
      document.getElementById('page-title').textContent = 'Editar Paciente';
      
      // Cargar datos del paciente
      cargarPaciente(patientId)
        .then(patient => {
          // Llenar formulario con datos del paciente
          document.getElementById('patient-id').value = patientId;
          
          // Llenar el formulario con los datos del paciente
          llenarFormularioPaciente(patient, 'patient-form');
          
          // Mostrar formulario
          document.getElementById('loading-form').style.display = 'none';
          document.getElementById('patient-form').style.display = 'block';
        })
        .catch(error => {
          console.error('Error al cargar paciente:', error);
          alert('Error al cargar datos del paciente. Por favor, intenta de nuevo.');
          window.location.href = 'listado-pacientes.html';
        });
    }
    
    // Función para guardar paciente
    function guardarPacienteForm() {
      // Validar campos obligatorios
      const nombreCompleto = document.getElementById('nombreCompleto').value.trim();
      
      if (!nombreCompleto) {
        alert('Por favor, ingresa el nombre del paciente');
        activarTab('datos-personales');
        document.getElementById('nombreCompleto').focus();
        return;
      }
      
      // Recopilar datos del formulario
      const formData = recopilarDatosFormulario('patient-form');
      
      // Preparar datos para guardar
      const patientData = prepararDatosPaciente(formData);
      
      // Mostrar mensaje de carga
      document.getElementById('save-patient-btn').innerHTML = '<i class="fas fa-spinner fa-spin"></i> Guardando...';
      document.getElementById('save-patient-btn').disabled = true;
      
      // Guardar o actualizar
      if (isEditMode) {
        actualizarPaciente(patientId, patientData)
          .then(() => {
            alert('Paciente actualizado correctamente');
            window.location.href = `ver-paciente.html?id=${patientId}`;
          })
          .catch(error => {
            console.error('Error al actualizar paciente:', error);
            alert('Error al actualizar paciente. Por favor, intenta de nuevo.');
            document.getElementById('save-patient-btn').innerHTML = '<i class="fas fa-save"></i> Guardar Paciente';
            document.getElementById('save-patient-btn').disabled = false;
          });
      } else {
        guardarPaciente(patientData)
          .then(newPatientId => {
            alert('Paciente guardado correctamente');
            window.location.href = `ver-paciente.html?id=${newPatientId}`;
          })
          .catch(error => {
            console.error('Error al guardar paciente:', error);
            alert('Error al guardar paciente. Por favor, intenta de nuevo.');
            document.getElementById('save-patient-btn').innerHTML = '<i class="fas fa-save"></i> Guardar Paciente';
            document.getElementById('save-patient-btn').disabled = false;
          });
      }
    }
    // Funcionalidad para agregar campos adicionales SINSS
document.addEventListener('DOMContentLoaded', function() {
  // Severidad
  document.getElementById('agregar_severidad_btn').addEventListener('click', function() {
    const container = document.getElementById('severidad_adicional_container');
    const fieldId = 'sinss_severidad_adicional_' + Date.now();
    
    const html = `
      <div class="form-row mb-3" id="${fieldId}_container">
        <div class="form-col form-col-md-10">
          <div class="form-group">
            <textarea id="${fieldId}" name="${fieldId}" class="form-control" rows="2" placeholder="Información adicional sobre la severidad..."></textarea>
          </div>
        </div>
        <div class="form-col form-col-md-2">
          <button type="button" class="btn btn-outline-danger btn-sm" onclick="eliminarCampo('${fieldId}_container')">
            <i class="fas fa-trash"></i> Eliminar
          </button>
        </div>
      </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
  });
  
  // Irritabilidad - Actividades
  document.getElementById('agregar_actividad_btn').addEventListener('click', function() {
    const container = document.getElementById('irritabilidad_actividades_container');
    const fieldId = 'sinss_irritabilidad_actividad_' + Date.now();
    
    const html = `
      <div class="form-row mb-3" id="${fieldId}_container">
        <div class="form-col form-col-md-10">
          <div class="form-group">
            <textarea id="${fieldId}" name="${fieldId}" class="form-control" rows="2" placeholder="Otra actividad que provoca dolor..."></textarea>
          </div>
        </div>
        <div class="form-col form-col-md-2">
          <button type="button" class="btn btn-outline-danger btn-sm" onclick="eliminarCampo('${fieldId}_container')">
            <i class="fas fa-trash"></i> Eliminar
          </button>
        </div>
      </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
  });
  
  // Irritabilidad - Adicional
  document.getElementById('agregar_irritabilidad_btn').addEventListener('click', function() {
    const container = document.getElementById('irritabilidad_adicional_container');
    const fieldId = 'sinss_irritabilidad_adicional_' + Date.now();
    
    const html = `
      <div class="form-row mb-3" id="${fieldId}_container">
        <div class="form-col form-col-md-10">
          <div class="form-group">
            <textarea id="${fieldId}" name="${fieldId}" class="form-control" rows="2" placeholder="Información adicional sobre la irritabilidad..."></textarea>
          </div>
        </div>
        <div class="form-col form-col-md-2">
          <button type="button" class="btn btn-outline-danger btn-sm" onclick="eliminarCampo('${fieldId}_container')">
            <i class="fas fa-trash"></i> Eliminar
          </button>
        </div>
      </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
  });
  
  // Naturaleza - Diagnóstico
  document.getElementById('agregar_diagnostico_btn').addEventListener('click', function() {
    const container = document.getElementById('naturaleza_diagnostico_container');
    const fieldId = 'sinss_naturaleza_diagnostico_' + Date.now();
    
    const html = `
      <div class="form-row mb-3" id="${fieldId}_container">
        <div class="form-col form-col-md-10">
          <div class="form-group">
            <textarea id="${fieldId}" name="${fieldId}" class="form-control" rows="2" placeholder="Otro diagnóstico..."></textarea>
          </div>
        </div>
        <div class="form-col form-col-md-2">
          <button type="button" class="btn btn-outline-danger btn-sm" onclick="eliminarCampo('${fieldId}_container')">
            <i class="fas fa-trash"></i> Eliminar
          </button>
        </div>
      </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
  });
  
  // Naturaleza - Dolor
  document.getElementById('agregar_dolor_btn').addEventListener('click', function() {
    const container = document.getElementById('naturaleza_dolor_container');
    const fieldId = 'sinss_naturaleza_dolor_' + Date.now();
    
    const html = `
      <div class="form-row mb-3" id="${fieldId}_container">
        <div class="form-col form-col-md-10">
          <div class="form-group">
            <textarea id="${fieldId}" name="${fieldId}" class="form-control" rows="2" placeholder="Otra característica del dolor..."></textarea>
          </div>
        </div>
        <div class="form-col form-col-md-2">
          <button type="button" class="btn btn-outline-danger btn-sm" onclick="eliminarCampo('${fieldId}_container')">
            <i class="fas fa-trash"></i> Eliminar
          </button>
        </div>
      </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
  });
  
  // Naturaleza - Factores
  document.getElementById('agregar_factores_btn').addEventListener('click', function() {
    const container = document.getElementById('naturaleza_factores_container');
    const fieldId = 'sinss_naturaleza_factores_' + Date.now();
    
    const html = `
      <div class="form-row mb-3" id="${fieldId}_container">
        <div class="form-col form-col-md-10">
          <div class="form-group">
            <textarea id="${fieldId}" name="${fieldId}" class="form-control" rows="2" placeholder="Otros factores biopsicosociales..."></textarea>
          </div>
        </div>
        <div class="form-col form-col-md-2">
          <button type="button" class="btn btn-outline-danger btn-sm" onclick="eliminarCampo('${fieldId}_container')">
            <i class="fas fa-trash"></i> Eliminar
          </button>
        </div>
      </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
  });
  
  // Estabilidad
  document.getElementById('agregar_estabilidad_btn').addEventListener('click', function() {
    const container = document.getElementById('estabilidad_adicional_container');
    const fieldId = 'sinss_estabilidad_adicional_' + Date.now();
    
    const html = `
      <div class="form-row mb-3" id="${fieldId}_container">
        <div class="form-col form-col-md-10">
          <div class="form-group">
            <textarea id="${fieldId}" name="${fieldId}" class="form-control" rows="2" placeholder="Información adicional sobre la estabilidad..."></textarea>
          </div>
        </div>
        <div class="form-col form-col-md-2">
          <button type="button" class="btn btn-outline-danger btn-sm" onclick="eliminarCampo('${fieldId}_container')">
            <i class="fas fa-trash"></i> Eliminar
          </button>
        </div>
      </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
  });
});

// Función para eliminar campos adicionales
function eliminarCampo(containerId) {
  const container = document.getElementById(containerId);
  if (container) {
    container.remove();
  }
}
  </script>
  <script src="js/responsive.js"></script>
  <script src="js/mapa-corporal.js"></script>
  <script src="js/cuestionarios.js"></script>
  <script>
// Reemplazar la función toggleCuestionario para garantizar que funcione
function toggleCuestionario(contentId) {
  console.log('Toggling cuestionario:', contentId);
  const content = document.getElementById(contentId);
  if (!content) {
    console.error('Content not found:', contentId);
    return;
  }
  
  const header = content.previousElementSibling;
  
  if (content.style.display === "none" || !content.style.display) {
    content.style.display = "block";
    if (header) header.classList.add("active");
  } else {
    content.style.display = "none";
    if (header) header.classList.remove("active");
  }
}

// Asegurar que la función está disponible globalmente
window.toggleCuestionario = toggleCuestionario;

// Inicializar manualmente los acordeones
document.addEventListener('DOMContentLoaded', function() {
  // Agregar listeners directamente a los headers
  document.querySelectorAll('.cuestionario-header').forEach(function(header) {
    header.addEventListener('click', function() {
      // Extraer el ID del contenido desde el atributo onclick
      const onclickAttr = this.getAttribute('onclick');
      if (onclickAttr && onclickAttr.includes('toggleCuestionario')) {
        // Obtener el ID entre paréntesis y comillas
        const matches = onclickAttr.match(/toggleCuestionario\(['"](.*?)['"]\)/);
        if (matches && matches[1]) {
          const contentId = matches[1];
          // Llamar a la función manualmente
          toggleCuestionario(contentId);
        }
      }
    });
  });

  // Marcar como inicializado
  console.log('Cuestionarios inicializados correctamente');
});
</script>
</body>
</html>
